(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-payment-payment"],{"0308":function(t,e,a){"use strict";a.r(e);var n=a("217c"),r=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},1337:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={uCard:a("d350").default,uxTag:a("cd75").default,uLine:a("c64f").default,uxCell:a("4697").default,uImage:a("2fa5").default,uxLayout:a("72d3").default,uButton:a("c0df").default},r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("u-card",{attrs:{"show-head":!1,"show-foot":!1}},[a("v-uni-view",{staticClass:"payment-price u-flex u-row-center u-font-40 u-font-bold u-type-error",attrs:{slot:"body"},slot:"body"},[a("ux-tag",{attrs:{price:t.paymentData.payableAmount}})],1)],1),a("v-uni-radio-group",{on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.payChange.apply(void 0,arguments)}}},[a("u-line",{attrs:{color:"#e4e7ed","hair-line":!1}}),t._l(t.paymentMethods,(function(e,n){return a("ux-cell",{key:e.channelProductId},[a("template",{staticClass:"u-flex",slot:"left"},[a("u-image",{staticClass:"u-m-r-10",attrs:{width:"50rpx",height:"50rpx",src:"http://shopro.7wpp.com/imgs/wx_pay.png"}}),a("v-uni-text",[t._v(t._s(e.channelProductShowName))])],1),a("template",{slot:"right"},[a("v-uni-radio",{attrs:{value:n,checked:t.payType==n}})],1)],2)}))],2),a("ux-layout",[a("v-uni-view",{staticClass:"u-m-t-40"},[a("u-button",{attrs:{type:"warning",plain:!0,shape:"circle"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmPayment.apply(void 0,arguments)}}},[a("ux-tag",{attrs:{"before-icon":"确认支付￥",price:t.paymentData.payableAmount}})],1)],1)],1)],1)},o=[]},"217c":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"u-line",props:{color:{type:String,default:"#e4e7ed"},length:{type:String,default:"100%"},direction:{type:String,default:"row"},hairLine:{type:Boolean,default:!0},margin:{type:String,default:"0"},borderStyle:{type:String,default:"solid"}},computed:{lineStyle:function(){var t={};return t.margin=this.margin,"row"==this.direction?(t.borderBottomWidth="1px",t.borderBottomStyle=this.borderStyle,t.width=this.$u.addUnit(this.length),this.hairLine&&(t.transform="scaleY(0.5)")):(t.borderLeftWidth="1px",t.borderLeftStyle=this.borderStyle,t.height=this.$u.addUnit(this.length),this.hairLine&&(t.transform="scaleX(0.5)")),t.borderColor=this.color,t}}};e.default=n},"2ed2":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */.u-card[data-v-54cf4226]{position:relative;overflow:hidden;font-size:%?28?%;background-color:#fff;-webkit-box-sizing:border-box;box-sizing:border-box}.u-card-full[data-v-54cf4226]{margin-left:0!important;margin-right:0!important;width:100%}.u-card--border[data-v-54cf4226]:after{border-radius:%?16?%}.u-card__head--left[data-v-54cf4226]{color:#303133}.u-card__head--left__thumb[data-v-54cf4226]{margin-right:%?16?%}.u-card__head--left__title[data-v-54cf4226]{max-width:%?400?%}.u-card__head--right[data-v-54cf4226]{color:#909399;margin-left:%?6?%}.u-card__body[data-v-54cf4226]{color:#606266}.u-card__foot[data-v-54cf4226]{color:#909399}',""]),t.exports=e},"367a":function(t,e,a){"use strict";a("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"u-card",props:{full:{type:Boolean,default:!1},title:{type:String,default:""},titleColor:{type:String,default:"#303133"},titleSize:{type:[Number,String],default:"30"},subTitle:{type:String,default:""},subTitleColor:{type:String,default:"#909399"},subTitleSize:{type:[Number,String],default:"26"},border:{type:Boolean,default:!0},index:{type:[Number,String,Object],default:""},margin:{type:String,default:"30rpx"},borderRadius:{type:[Number,String],default:"16"},headStyle:{type:Object,default:function(){return{}}},bodyStyle:{type:Object,default:function(){return{}}},footStyle:{type:Object,default:function(){return{}}},headBorderBottom:{type:Boolean,default:!0},footBorderTop:{type:Boolean,default:!0},thumb:{type:String,default:""},thumbWidth:{type:[String,Number],default:"60"},thumbCircle:{type:Boolean,default:!1},padding:{type:[String,Number],default:"30"},showHead:{type:Boolean,default:!0},showFoot:{type:Boolean,default:!0},boxShadow:{type:String,default:"none"}},data:function(){return{}},methods:{click:function(){this.$emit("click",this.index)},headClick:function(){this.$emit("head-click",this.index)},bodyClick:function(){this.$emit("body-click",this.index)},footClick:function(){this.$emit("foot-click",this.index)}}};e.default=n},"475b":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,".payment-price[data-v-b1c313b2]{height:%?210?%}",""]),t.exports=e},"4a6c":function(t,e,a){var n=a("475b");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var r=a("4f06").default;r("3d2051ce",n,!0,{sourceMap:!1,shadowMode:!1})},"59f5":function(t,e,a){var n=a("cb50");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var r=a("4f06").default;r("a67dd768",n,!0,{sourceMap:!1,shadowMode:!1})},"5e90":function(t,e,a){"use strict";a.r(e);var n=a("1337"),r=a("a5a1");for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("f58e");var i,u=a("f0c5"),d=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,"b1c313b2",null,!1,n["a"],i);e["default"]=d.exports},"6bcc":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"u-line",style:[t.lineStyle]})},o=[]},7740:function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"u-card",class:{"u-border":t.border,"u-card-full":t.full,"u-card--border":t.borderRadius>0},style:{borderRadius:t.borderRadius+"rpx",margin:t.margin,boxShadow:t.boxShadow},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.click.apply(void 0,arguments)}}},[t.showHead?a("v-uni-view",{staticClass:"u-card__head",class:{"u-border-bottom":t.headBorderBottom},style:[{padding:t.padding+"rpx"},t.headStyle],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.headClick.apply(void 0,arguments)}}},[t.$slots.head?t._t("head"):a("v-uni-view",{staticClass:"u-flex u-row-between"},[t.title?a("v-uni-view",{staticClass:"u-card__head--left u-flex u-line-1"},[t.thumb?a("v-uni-image",{staticClass:"u-card__head--left__thumb",style:{height:t.thumbWidth+"rpx",width:t.thumbWidth+"rpx",borderRadius:t.thumbCircle?"100rpx":"6rpx"},attrs:{src:t.thumb,mode:"aspectfull"}}):t._e(),a("v-uni-text",{staticClass:"u-card__head--left__title u-line-1",style:{fontSize:t.titleSize+"rpx",color:t.titleColor}},[t._v(t._s(t.title))])],1):t._e(),t.subTitle?a("v-uni-view",{staticClass:"u-card__head--right u-line-1"},[a("v-uni-text",{staticClass:"u-card__head__title__text",style:{fontSize:t.subTitleSize+"rpx",color:t.subTitleColor}},[t._v(t._s(t.subTitle))])],1):t._e()],1)],2):t._e(),a("v-uni-view",{staticClass:"u-card__body",style:[{padding:t.padding+"rpx"},t.bodyStyle],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.bodyClick.apply(void 0,arguments)}}},[t._t("body")],2),t.showFoot?a("v-uni-view",{staticClass:"u-card__foot",class:{"u-border-top":t.footBorderTop},style:[{padding:t.$slots.foot?t.padding+"rpx":0},t.footStyle],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.footClick.apply(void 0,arguments)}}},[t._t("foot")],2):t._e()],1)},o=[]},"774b":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PAYMENT=void 0;var n={APP:[{provider:"wxpay",channelProductId:"wxApp",channelProductShowName:"微信支付",channelProductName:"微信App支付"},{provider:"alipay",channelProductId:"aliApp",channelProductShowName:"支付宝支付",channelProductName:"支付宝APP支付"}],"MP-WEIXIN":[{provider:"wxpay",channelProductId:"wxMiniApp",channelProductShowName:"微信支付",channelProductName:"微信小程序支付"}]};e.PAYMENT=n},"798f":function(t,e,a){var n=a("2ed2");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var r=a("4f06").default;r("39ecd493",n,!0,{sourceMap:!1,shadowMode:!1})},a5a1:function(t,e,a){"use strict";a.r(e);var n=a("afe0"),r=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},afe0:function(t,e,a){"use strict";var n=a("4ea4");a("d3b7"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var r=n(a("1da1")),o=n(a("5530")),i=a("2f62"),u=a("4839"),d=a("774b"),c={onLoad:function(){var t=this.$Route.query;this.paymentData=t,console.log("[payment:]",t)},created:function(){this.paymentMethods=d.PAYMENT[this.platform]},data:function(){return{paymentData:null,payType:0,paymentMethods:null,maxReqNum:1}},computed:(0,o.default)((0,o.default)((0,o.default)({},(0,i.mapGetters)("user",["billId"])),(0,i.mapState)("user",["openId"])),(0,i.mapState)(["platform"])),methods:{payChange:function(t){console.log(t),console.log(t.detail.value),this.payType=t.detail.value},queryPayment:function(t){var e=this;return new Promise(function(){var a=(0,r.default)(regeneratorRuntime.mark((function a(n){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,u.queryPaymentByTrade)(t);case 2:if(r=a.sent,o=r.result,0!==o.length){a.next=7;break}return e.maxReqNum<20?(e.maxReqNum++,setTimeout((function(){e.queryPayment(t)}),1500)):e.$u.toast("未请求到支付单"),a.abrupt("return");case 7:n(r);case 8:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}())},confirmPayment:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var a,n,r,i,d,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=JSON.parse(JSON.stringify(t.paymentMethods[t.payType])),n=t.paymentData.tradeOrderId,delete a.channelProductShowName,r={appId:"1",outTradeNo:n,paymentProductDTO:(0,o.default)((0,o.default)({},a),{},{extra:{openid:"ojJ1M5FORsHqwOrI3iuqNyNL6iTM"}})},e.next=6,(0,u.choicePayment)(r);case 6:if(i=e.sent,console.log(i),200!==i.code){e.next=18;break}return e.next=11,t.queryPayment(n);case 11:d=e.sent,c=d.result,l=null,l=c[0].paymentProductVO.responseVO.response,t.reqPayment(l),e.next=19;break;case 18:t.$u.toast("订单信息不正确");case 19:case"end":return e.stop()}}),e)})))()},reqPayment:function(t){console.log("reqPayment",t);var e={provider:"",success:function(t){console.log(t,"<===uni.requestPayment"),uni.showModal({title:"提示",content:"支付成功",showCancel:!1})},fail:function(t){console.log(t),uni.showModal({title:"提示",content:"支付失败",showCancel:!1})}};e.provider=this.paymentMethods[this.payType].provider,e.orderInfo=t,uni.requestPayment(e)}}};e.default=c},c5f0:function(t,e,a){"use strict";var n=a("798f"),r=a.n(n);r.a},c64f:function(t,e,a){"use strict";a.r(e);var n=a("6bcc"),r=a("0308");for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("d82c");var i,u=a("f0c5"),d=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,"234777da",null,!1,n["a"],i);e["default"]=d.exports},cb50:function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */.u-line[data-v-234777da]{vertical-align:middle}',""]),t.exports=e},d350:function(t,e,a){"use strict";a.r(e);var n=a("7740"),r=a("dae0");for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("c5f0");var i,u=a("f0c5"),d=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,"54cf4226",null,!1,n["a"],i);e["default"]=d.exports},d82c:function(t,e,a){"use strict";var n=a("59f5"),r=a.n(n);r.a},dae0:function(t,e,a){"use strict";a.r(e);var n=a("367a"),r=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},f58e:function(t,e,a){"use strict";var n=a("4a6c"),r=a.n(n);r.a}}]);